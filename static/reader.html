<!DOCTYPE html>
<html ng-app="libraryApp" lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Bootstrap 101 Template</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="/css/base.css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
    <p>Click <a href="/logout">here</a> to logout</p>

    <h2>Branches</h2>
    <div ng-controller="BranchListCtrl">
        <ul class="branches">
            <li ng-repeat="branch in branches">
                <span>id: {{branch.lib_id}} - {{branch.name}}</span>
                <p>Location: {{branch.location}}</p>
            </li>
        </ul>
    </div>

    <hr />

    <h2>Books</h2>
    <div ng-controller="BookListCtrl">
        <ul class="books">
            <li ng-repeat="book in books">
                <span>id: {{book.book_id}} - {{book.title}}</span>
                <p>ISBN: {{book.ISBN}}</p>
            </li>
        </ul>
    </div>

    <hr />

    <h2>Book Search</h2>
    <div ng-controller="BookSearchCtrl">
        <form novalidate>
            <label for="searchBookId">BookId:</label>
            <input type="text" id="searchBookId" ng-model="toSearch.book_id" /><br />
            <label for="searchBookTitle">Title: </label>
            <input type="text" id="searchBookTitle" ng-model="toSearch.title" /><br />
            <label for="searchBookPublisherName">Publisher Name: </label>
            <input type="text" id="searchBookPublisherName" ng-model="toSearch.publisher_name" /><br />
            <input type="submit" ng-click="retrieve(toSearch)" />
        </form>
        <div ng-show="books">
            <br />
            <h4>Results: </h4>
            <table class="books">
                <tr>
                    <th>BookId</th>
                    <th>Title</th>
                    <th>ISBN</th>
                    <th>Publish Date</th>
                    <th>Publisher</th>
                </tr>
                <tr ng-repeat="book in books">
                    <td>{{book.book_id}}</td>
                    <td>{{book.title}}</td>
                    <td>{{book.ISBN}}</td>
                    <td>{{book.publish_date}}</td>
                    <td>{{book.publisher_id}}</td>
                </tr>
            </table>
        </div>
    </div>

    <hr />

    <h2>Book Add</h2>
    <div ng-controller="BookAddCtrl">
        <form novalidate>
            <label for="addBookTitle">Title: </label>
            <input type="text" id="addBookTitle" ng-model="toAdd.title" /><br />
            <label for="addBookISBN">ISBN: </label>
            <input type="text" id="addBookISBN" ng-model="toAdd.ISBN" /><br />
            <label for="addBookPublisherId">PublisherId: </label>
            <input type="text" id="addBookPublisherId" ng-model="toAdd.publisher_id" /><br />
            <label for="addBookPublishDate">Publish Date: </label>
            <input type="text" id="addBookPublishDate" ng-model="toAdd.publish_date" placeholder="YYYY-MM-DD"/><br />
            <input type="submit" ng-click="add(toAdd)" />
        </form>

        <div ng-show="result">
            <span>{{result}}</span>
        </div>
    </div>

    <hr />

    <h2>Readers</h2>
    <div ng-controller="ReaderListCtrl">
        <form>
            <select ng-options="reader.name for reader in readers" ng-model="selectedReader" ng-change="getSelectedReaderInfo()"></select>
        </form>
        <ul>
            <li>Name: {{selectedReader.name}}</li>
            <li>Address: {{selectedReader.address}}</li>
            <li>Phone: {{selectedReader.phone}}</li>
            <li>Reserves: <span ng-repeat="reserve in selectedReaderInfo.reserves">{{reserve.reserve_id}}, </span></li>
            <li>Borrows: <span ng-repeat="borrow in selectedReaderInfo.borrows">
                <span am-time-ago="borrow.b_datetime"></span>
                 ~ {{borrow.r_datetime | amDateFormat:'MMM. DD YYYY'}},<br />
            </span></li>
        </ul>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.2/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-moment/0.10.1/angular-moment.min.js"></script>
    <script src="/js/books.js"></script>
</body>
</html>